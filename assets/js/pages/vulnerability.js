const saveVulnerabilityButton = document.querySelector("#saveVulnerability");
const approveVulnerabilitySwitch = document.querySelector("#switchApproveVulnerability");
const webPenetrationCheckbox = document.querySelector("#chkWebPenetration");
const serverPenetrationCheckbox = document.querySelector("#chkServerPenetration");
const scadaPenetrationCheckbox = document.querySelector("#chkScadaPenetration");
const blockchainPenetrationCheckbox = document.querySelector("#chkBlockchainPenetration");
const contratPenetrationCheckbox = document.querySelector("#chkContratPenetration");


webContents.on("dom-ready", () => {
    loadData();
});

const loadData = () => {
    if (localStorage.getItem("vulnerability")) {
        let vulnerabilityData = JSON.parse(localStorage.vulnerability);
        approveVulnerabilitySwitch.checked = vulnerabilityData.approveVulnerability;
        webPenetrationCheckbox.checked = vulnerabilityData.webPenetration;
        serverPenetrationCheckbox.checked = vulnerabilityData.serverPenetration;
        scadaPenetrationCheckbox.checked = vulnerabilityData.scadaPenetration;
        blockchainPenetrationCheckbox.checked = vulnerabilityData.blokchainPenetration;
        contratPenetrationCheckbox.checked = vulnerabilityData.contratPenetration;
    }
}

saveVulnerabilityButton.addEventListener('click', () => {
    const Vulnerability = {
        approveVulnerability: approveVulnerabilitySwitch.checked,
        webPenetration: webPenetrationCheckbox.checked,
        serverPenetration: serverPenetrationCheckbox.checked,
        scadaPenetration: scadaPenetrationCheckbox.checked,
        blokchainPenetration: blockchainPenetrationCheckbox.checked,
        contratPenetration: contratPenetrationCheckbox.checked
    };

    localStorage.removeItem("vulnerability");
    localStorage.setItem("vulnerability", JSON.stringify(Vulnerability));

    localStorage.notificationCount ? localStorage["notificationCount"] = parseInt(localStorage["notificationCount"]) + 1 : localStorage.setItem("notificationCount", 1);
    alertCountSpan.innerHTML = localStorage["notificationCount"];

    if (!alertCountSpan.classList.contains("alert-count")) {
        alertCountSpan.classList.add("alert-count");
    }

    savedSuccessNotify();
    checkNotifications();
});